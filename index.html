<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no" />
  <title>Counter</title>
  <!-- Force dark UI for browser chrome where possible (iOS/Android) -->
  <meta name="theme-color" content="#000000">
  <meta name="color-scheme" content="dark only">
  <meta name="supported-color-schemes" content="dark">
  <!-- iOS PWA / Safari status bar -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <style>
    :root {
      --base: 180px; /* taller buttons */
      --btn-width: auto; /* width now responsive to grid */
    }
    html, body { /* true black for OLED */
      margin: 0; height: 100%; background: #000; color: #fff;
      font-family: "Segoe UI", -apple-system, BlinkMacSystemFont, Inter, Arial, sans-serif;
      -webkit-font-smoothing: antialiased;
      overflow: hidden;
      user-select: none; -webkit-user-select: none; -webkit-touch-callout: none;
      -webkit-tap-highlight-color: transparent;
      background-color: #000; overscroll-behavior: none;
    }
    .app { min-height:100%; padding: env(safe-area-inset-top) 16px env(safe-area-inset-bottom);
      display:flex; flex-direction:column; align-items:center; justify-content:space-between; box-sizing:border-box; text-align:center; }

    /* Top group */
    .top { padding-top:4px; display:flex; flex-direction:column; align-items:center; justify-content:center; }
    .top h1 { margin:0; font-size:20px; font-weight:600; }
    .sound-toggle { margin:8px auto 0; border:none; background:transparent; color:#fff; cursor:pointer; width:32px; height:32px; display:flex; align-items:center; justify-content:center; }
    .sound-toggle svg { width:24px; height:24px; display:none; }
    .sound-toggle svg.active { display:block; }

    /* Middle */
    .value { font-size: clamp(96px, 18vw, 160px); font-weight:800; line-height:1; margin:0; font-variant-numeric: tabular-nums; }

    /* Bottom */
    .bottom { width:100%; }
    #reset { width:180px; margin:0 auto 16px; padding:12px 24px; border-radius:20px; border:2px solid #333; background:#111; color:#fff; font-size:18px; letter-spacing:.2em; cursor:pointer; transition: background .12s ease, border-color .12s ease; }
    #reset:hover { border-color:#fff; background: rgba(255,255,255,.06); }
    .controls { display:grid; grid-template-columns:minmax(0,1fr) minmax(0,1fr); gap: var(--grid-gap, 18px); justify-items:stretch; align-items:stretch; width:100%; margin-bottom:8px; }
    .btn { width:100%; height: var(--base); background:#111; border-radius:20px; color:#fff; border:2px solid #333; display:grid; place-items:center; touch-action:manipulation; transition: transform .08s ease, box-shadow .12s ease, background .12s ease, border-color .12s ease; position:relative; overflow:hidden; }
    .btn:hover { border-color:#fff; background: rgba(255,255,255,.06); }
    .btn.is-pressing { transform: scale(.94); background:#141414; box-shadow: inset 0 0 0 2px rgba(255,255,255,.08), inset 0 10px 30px rgba(255,255,255,.06); }
    .glyph { width:46%; height:46%; display:block; }
    .btn-minus .glyph { width:42%; height:42%; }
    .note { text-align:center; color:#bbb; font-size:11px; opacity:.7; }

    /* Overlay */
    .overlay { position:fixed; inset:0; background:#000; color:#fff; z-index:1000; display:flex; flex-direction:column; align-items:center; justify-content:center; transition: opacity .25s ease; }
    .overlay.hidden { opacity:0; pointer-events:none; }
    .overlay h2 { margin:0; font-size:28px; font-weight:700; }
    .overlay h2 small { display:block; font-size:14px; font-weight:400; opacity:.8; margin-top:4px; }
    .overlay .hint { margin-top:12px; font-size:14px; opacity:.7; animation:pulse 1.5s ease-in-out infinite; }
    @keyframes pulse { 0%,100%{opacity:.5} 50%{opacity:1} }
  </style>
</head>
<body>
  <div class="app" id="app">
    <div class="top">
      <h1>Counter</h1>
      <button id="sound-toggle" class="sound-toggle" aria-label="Toggle sound">
        <svg class="icon-on" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M18 8a6 6 0 0 0-12 0c0 7-3 9-3 9h18s-3-2-3-9" />
          <path d="M13.73 21a2 2 0 0 1-3.46 0" />
        </svg>
        <svg class="icon-off" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M18 8a6 6 0 0 0-12 0c0 7-3 9-3 9h18s-3-2-3-9" />
          <path d="M13.73 21a2 2 0 0 1-3.46 0" />
          <path d="M1 1l22 22" />
        </svg>
      </button>
    </div>

    <div class="middle">
      <div class="value" id="value">0</div>
    </div>

    <div class="bottom">
      <button id="reset" aria-label="Reset">RESET</button>
      <div class="controls">
        <button class="btn btn-minus" id="dec" aria-label="Decrease">
          <svg class="glyph" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M5 12h14" stroke="currentColor" stroke-width="3" stroke-linecap="round" fill="none" />
          </svg>
        </button>
        <button class="btn btn-plus" id="inc" aria-label="Increase">
          <svg class="glyph" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="3" stroke-linecap="round" fill="none" />
          </svg>
        </button>
      </div>
      <div class="note">hold for faster value</div>
    </div>
  </div>

  <div class="overlay" id="overlay">
    <h2>Counter<small>by StarShots ID</small></h2>
    <div class="hint">Tap anywhere to start</div>
  </div>

  <script>
    (function(){
      const TAP_GAP_MS=300,HOLD_START_MS=600,START_DELAY_MS=350,MIN_DELAY_MS=18,SPEEDUP=0.85;
      const valueEl=document.getElementById('value');
      const incBtn=document.getElementById('inc');
      const decBtn=document.getElementById('dec');
      const resetBtn=document.getElementById('reset');
      const soundToggle=document.getElementById('sound-toggle');
      const iconOn=soundToggle.querySelector('.icon-on');
      const iconOff=soundToggle.querySelector('.icon-off');
      const overlayEl=document.getElementById('overlay');

      let total=parseInt(localStorage.getItem('counter:total')||'0',10);
      let soundOn=localStorage.getItem('soundOn')!=='false';
      let audioCtx; let audioReadyAt=0;

      function render(){ valueEl.textContent=total; }
      function save(){ localStorage.setItem('counter:total',String(total)); }
      function step(d){ total=Math.max(0,total+d); render(); save(); }

      function ensureAudio(){ if(!audioCtx){ audioCtx=new (window.AudioContext||window.webkitAudioContext)(); } return audioCtx.state==='suspended'?audioCtx.resume():Promise.resolve(); }
      function warmAudio(){ return ensureAudio().then(()=>{ const ctx=audioCtx; const o=ctx.createOscillator(); const g=ctx.createGain(); g.gain.value=0.0001; o.connect(g).connect(ctx.destination); o.start(); o.stop(ctx.currentTime+0.02); audioReadyAt=performance.now()+80; }); }

      function playClick(freq){ if(!soundOn){ if(navigator.vibrate) navigator.vibrate(8); return; } const ctx=audioCtx,t=ctx.currentTime,o=ctx.createOscillator(),g=ctx.createGain(); o.type='sine'; o.frequency.setValueAtTime(freq,t); g.gain.setValueAtTime(0,t); g.gain.linearRampToValueAtTime(0.15,t+0.005); g.gain.exponentialRampToValueAtTime(0.001,t+0.12); o.connect(g).connect(ctx.destination); o.start(t); o.stop(t+0.14); }

      function clickSound(freq){ const now=performance.now(); if(now<audioReadyAt){ setTimeout(()=>playClick(freq),audioReadyAt-now); } else { playClick(freq); } }

      function updateSoundIcon(){ if(soundOn){ iconOn.classList.add('active'); iconOff.classList.remove('active'); } else { iconOn.classList.remove('active'); iconOff.classList.add('active'); } }
      updateSoundIcon();
      soundToggle.addEventListener('click',(e)=>{ e.stopPropagation(); soundOn=!soundOn; localStorage.setItem('soundOn',soundOn?'true':'false'); updateSoundIcon(); });

      overlayEl.classList.remove('hidden');
      overlayEl.addEventListener('click',()=>{ overlayEl.classList.add('hidden'); warmAudio(); },{once:true});

      function attachPress(btn,delta,freq){ let holdTimer=null,repeatTimer=null,long=false,lastTap=0,id=null; const onDown=(e)=>{ e.preventDefault(); id=e.pointerId??null; if(id!=null&&btn.setPointerCapture) btn.setPointerCapture(id); btn.classList.add('is-pressing'); long=false; clearTimeout(holdTimer); clearTimeout(repeatTimer); holdTimer=setTimeout(()=>{ long=true; let delay=START_DELAY_MS; const tick=()=>{ step(delta); clickSound(freq); delay=Math.max(MIN_DELAY_MS,delay*SPEEDUP); repeatTimer=setTimeout(tick,delay); }; tick(); },HOLD_START_MS); }; const cleanup=()=>{ btn.classList.remove('is-pressing'); if(id!=null&&btn.hasPointerCapture?.(id)) btn.releasePointerCapture(id); id=null; clearTimeout(holdTimer); clearTimeout(repeatTimer); }; const onUp=()=>{ const wasLong=long; cleanup(); if(!wasLong){ const now=Date.now(); if(now-lastTap>=TAP_GAP_MS){ step(delta); clickSound(freq); lastTap=now; } } }; btn.addEventListener('pointerdown',onDown); btn.addEventListener('pointerup',onUp); btn.addEventListener('pointercancel',cleanup); }

      attachPress(incBtn,+1,880); // brighter louder tone
      attachPress(decBtn,-1,440); // lower tone
      resetBtn.addEventListener('click',()=>{ total=0; render(); save(); clickSound(330); });

      render();
      document.addEventListener('contextmenu',e=>e.preventDefault());
    })();
  </script>
</body>
</html>
